import{j as Z}from"./jsx-runtime.CyXy1Ci3.js";import{r as K,R as _}from"./index.CaZlGE7t.js";const et=({children:v,fontSize:o="clamp(2rem, 8vw, 8rem)",fontWeight:m=900,fontFamily:f="inherit",color:g="#fff",enableHover:s=!0,baseIntensity:w=.18,hoverIntensity:y=.5})=>{const T=K.useRef(null);return K.useEffect(()=>{let z,B=!1;const t=T.current;if(!t){console.warn("FuzzyText: Canvas ref not found");return}return console.log("FuzzyText: Initializing with props:",{children:v,fontSize:o,fontWeight:m,fontFamily:f,color:g,enableHover:s,baseIntensity:w,hoverIntensity:y}),(async()=>{if(document.fonts?.ready&&await document.fonts.ready,B)return;const h=t.getContext("2d");if(!h)return;const L=f==="inherit"?window.getComputedStyle(t).fontFamily||"sans-serif":f,R=typeof o=="number"?`${o}px`:o;let x;if(typeof o=="number")x=o;else{const e=document.createElement("span");e.style.fontSize=o,document.body.appendChild(e);const n=window.getComputedStyle(e).fontSize;x=parseFloat(n),document.body.removeChild(e)}const M=_.Children.toArray(v).join(""),p=document.createElement("canvas"),c=p.getContext("2d");if(!c)return;c.font=`${m} ${R} ${L}`,c.textBaseline="alphabetic";const u=c.measureText(M),A=u.actualBoundingBoxLeft??0,N=u.actualBoundingBoxRight??u.width,$=u.actualBoundingBoxAscent??x,P=u.actualBoundingBoxDescent??x*.2,j=Math.ceil(A+N),a=Math.ceil($+P),D=10,i=j+D;p.width=i,p.height=a;const S=D/2;c.font=`${m} ${R} ${L}`,c.textBaseline="alphabetic",c.fillStyle=g,c.fillText(M,S-A,$);const E=50,C=0;t.width=i+E*2,t.height=a+C*2,h.translate(E,C);const X=E+S,Y=C,Q=X+j,U=Y+a;let l=!1;const d=30,q=()=>{if(B)return;h.clearRect(-d,-d,i+2*d,a+2*d);const e=l?y:w;for(let n=0;n<a;n++){const r=Math.floor(e*(Math.random()-.5)*d);h.drawImage(p,0,n,i,1,r,n,i,1)}z=window.requestAnimationFrame(q)};console.log("FuzzyText: Canvas dimensions:",{width:t.width,height:t.height,offscreenWidth:i,tightHeight:a}),q();const O=(e,n)=>e>=X&&e<=Q&&n>=Y&&n<=U,k=e=>{if(!s)return;const n=t.getBoundingClientRect(),r=e.clientX-n.left,F=e.clientY-n.top;l=O(r,F)},G=()=>{l=!1},I=e=>{if(!s)return;e.preventDefault();const n=t.getBoundingClientRect(),r=e.touches[0],F=r.clientX-n.left,W=r.clientY-n.top;l=O(F,W)},J=()=>{l=!1};s&&(t.addEventListener("mousemove",k),t.addEventListener("mouseleave",G),t.addEventListener("touchmove",I,{passive:!1}),t.addEventListener("touchend",J));const V=()=>{window.cancelAnimationFrame(z),s&&(t.removeEventListener("mousemove",k),t.removeEventListener("mouseleave",G),t.removeEventListener("touchmove",I),t.removeEventListener("touchend",J))};t.cleanupFuzzyText=V})(),()=>{B=!0,window.cancelAnimationFrame(z),t&&t.cleanupFuzzyText&&t.cleanupFuzzyText()}},[v,o,m,f,g,s,w,y]),Z.jsx("canvas",{ref:T})};export{et as default};
